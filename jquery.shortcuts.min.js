(function(e){var t={backspace:8,tab:9,enter:13,pause:19,capslock:20,esc:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,"?":191,minus:e.browser.opera?[109,45]:e.browser.mozilla?109:[189,109],plus:e.browser.opera?[61,43]:e.browser.mozilla?[61,107]:[187,107]};var n={};var r;var i={};var s=false;var o=function(t,n){var r=t;if(n.ctrl){r+="_ctrl"}if(n.alt){r+="_alt"}if(n.shift){r+="_shift"}var i=function(e,t){if(t&&t!==16&&t!==17&&t!==18){e+="_"+t}return e};if(e.isArray(n.which)){var s=[];e.each(n.which,function(e,t){s.push(i(r,t))});return s}else{return i(r,n.which)}};var u=function(n){var r={};var i=n.split("+");e.each(i,function(e,n){if(n==="ctrl"||n==="alt"||n==="shift"){r[n]=true}else{r.which=t[n]||n.toUpperCase().charCodeAt()}});return r};var a=function(t){var n=t.tagName.toLowerCase();var r=t.type;return n==="input"&&e.inArray(r,["text","password","file","search"])>-1||n==="textarea"||n==="span"&&t.contentEditable==="true"};var f=function(t,n){if(!r){return}var i={ctrl:n.ctrlKey,alt:n.altKey,shift:n.shiftKey,which:n.which};var s=o(t,i);var u=r[s];if(!u){return}var f=a(n.target);var l=false;e.each(u,function(e,t){if(!f||t.enableInInput){if(!l){n.preventDefault();l=true}t.handler(n)}})};e.Shortcuts={};e.Shortcuts.start=function(t){t=t||"default";r=n[t];if(s){return}e(document).bind((e.browser.opera?"keypress":"keydown")+".shortcuts",function(e){if(e.type==="keypress"&&e.which>=97&&e.which<=122){e.which=e.which-32}if(!i[e.which]){f("down",e)}i[e.which]=true;f("hold",e)});e(document).bind("keyup.shortcuts",function(e){i[e.which]=false;f("up",e)});s=true;return this};e.Shortcuts.stop=function(){e(document).unbind("keypress.shortcuts keydown.shortcuts keyup.shortcuts");s=false;return this};e.Shortcuts.add=function(t){if(!t.mask){throw new Error("$.Shortcuts.add: required parameter 'params.mask' is undefined.")}if(!t.handler){throw new Error("$.Shortcuts.add: required parameter 'params.handler' is undefined.")}var r=t.type||"down";var i=t.list?t.list.replace(/\s+/g,"").split(","):["default"];e.each(i,function(i,s){if(!n[s]){n[s]={}}var a=n[s];var f=t.mask.toLowerCase().replace(/\s+/g,"").split(",");e.each(f,function(n,i){var s=u(i);var f=o(r,s);if(!e.isArray(f)){f=[f]}e.each(f,function(e,n){if(!a[n]){a[n]=[]}a[n].push(t)})})});return this};e.Shortcuts.remove=function(t){if(!t.mask){throw new Error("$.Shortcuts.remove: required parameter 'params.mask' is undefined.")}var r=t.type||"down";var i=t.list?t.list.replace(/\s+/g,"").split(","):["default"];e.each(i,function(i,s){if(!n[s]){return true}var a=t.mask.toLowerCase().replace(/\s+/g,"").split(",");e.each(a,function(t,i){var a=u(i);var f=o(r,a);if(!e.isArray(f)){f=[f]}e.each(f,function(e,t){delete n[s][t]})})});return this}})(jQuery)
